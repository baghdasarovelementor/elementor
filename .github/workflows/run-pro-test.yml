name: Trigger Remote Workflow and Wait

on:
  push:
  pull_request:

jobs:
  trigger_and_wait:
    runs-on: ubuntu-latest

    steps:
      # Step 1: Trigger the remote workflow and wait for its completion
      - name: Trigger remote workflow and wait
        uses: benc-uk/workflow-dispatch@v1
        with:
          owner: elementor
          repo: elementor-pro
          workflow: playwright.yml
          ref: main
          token: ${{ secrets.GITHUB_TOKEN }}
          inputs: '{"event_type":"run-from-core"}'
          wait: true
          interval: 10
          timeout: 1200

      # Step 2: Handle success/failure
      - name: Check conclusion
        if: success()
        run: echo "Remote workflow completed successfully!"

      - name: Handle failure
        if: failure()
        run: echo "Remote workflow failed!" && exit 1
